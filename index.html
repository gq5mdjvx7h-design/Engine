<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¦Š Heures Sup' Ultimate</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <!-- SÃ‰LECTEUR DE MODE -->
    <div id="modeSelector" class="mode-selector active">
        <div class="mode-card">
            <h1>ğŸ¦Š Heures Sup' Ultimate</h1>
            <p class="subtitle">SystÃ¨me complet de gestion et analyse</p>
            <div class="mode-buttons">
                <button class="mode-btn" onclick="selectMode('demo')">
                    <span class="mode-icon">ğŸ®</span>
                    <h3>Mode DÃ©mo</h3>
                    <p>DonnÃ©es prÃ©chargÃ©es (Niv.12, 3200 XP, 10 badges)</p>
                </button>
                <button class="mode-btn" onclick="selectMode('normal')">
                    <span class="mode-icon">ğŸ’¼</span>
                    <h3>Mode Production</h3>
                    <p>Vos donnÃ©es personnelles, sauvegarde auto</p>
                </button>
                <button class="mode-btn" onclick="selectMode('dev')">
                    <span class="mode-icon">ğŸ› ï¸</span>
                    <h3>Mode Dev</h3>
                    <p>Panneau debug, +XP, unlock all badges</p>
                </button>
            </div>
        </div>
    </div>

    <!-- APPLICATION PRINCIPALE -->
    <div id="mainApp" class="main-app" style="display:none;">

        <div class="background-layer" id="bg-spring"></div>
        <div class="background-layer" id="bg-summer"></div>
        <div class="background-layer" id="bg-autumn"></div>
        <div class="background-layer" id="bg-winter"></div>

        <div class="fox-character" onclick="toggleFoxDialogue()">
            <div id="fox-img-container">ğŸ¦Š</div>
        </div>

        <div class="fox-dialogue" id="foxDialogue">
            <p id="foxText">Bonjour ! Je suis Kitsune, votre guide. ğŸ¦Š</p>
        </div>

        <div class="game-container">

            <header class="app-header">
                <h1 class="app-title">ğŸ¦Š Heures Sup' Ultimate</h1>
                <div class="mode-indicator" id="modeIndicator">Mode: Production</div>
                <div class="global-stats">
                    <div class="stat-item"><span class="stat-label">Niveau</span><span class="stat-value" id="globalLevel">1</span></div>
                    <div class="stat-item"><span class="stat-label">XP</span><span class="stat-value" id="globalXP">0</span></div>
                    <div class="stat-item"><span class="stat-label">Sagesse</span><span class="stat-value" id="globalWisdom">0</span></div>
                    <div class="stat-item"><span class="stat-label">ScÃ©narios</span><span class="stat-value" id="globalScenarios">0/600</span></div>
                </div>
            </header>

            <nav class="module-nav">
                <button class="module-btn active" onclick="switchModule('dashboard')">ğŸ“Š Dashboard</button>
                <button class="module-btn" onclick="switchModule('module1')">ğŸ“… Module 1</button>
                <button class="module-btn" onclick="switchModule('module2')">ğŸ“† Module 2</button>
                <button class="module-btn" onclick="switchModule('module3')">ğŸ® RPG</button>
                <button class="module-btn" onclick="switchModule('scenarios')">ğŸ“– 600 ScÃ©narios</button>
                <a href="modules/module-ia/index.html" target="_blank" class="module-btn" style="text-decoration:none;background:linear-gradient(135deg,#7b2ff7,#ff6b9d);color:#fff;border:none;padding:10px 18px;cursor:pointer;">ğŸ¤– Module IA</a>
            </nav>

            <div id="module-dashboard" class="module-content active">
                <h2>ğŸ“Š Vue d'ensemble</h2>
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>ğŸ“… Suivi Annuel</h3>
                        <p>Heures totales : <strong id="dash-annual-hours">0h</strong></p>
                        <p>Heures sup : <strong id="dash-annual-overtime">0h</strong></p>
                        <button class="btn-primary" onclick="switchModule('module1')">Voir Module 1</button>
                    </div>
                    <div class="dashboard-card">
                        <h3>ğŸ“† Suivi Mensuel</h3>
                        <p>Mois en cours : <strong id="dash-current-month">-</strong></p>
                        <p>Heures ce mois : <strong id="dash-monthly-hours">0h</strong></p>
                        <button class="btn-primary" onclick="switchModule('module2')">Voir Module 2</button>
                    </div>
                    <div class="dashboard-card">
                        <h3>ğŸ® Progression RPG</h3>
                        <p>Niveau : <strong id="dash-rpg-level">1</strong></p>
                        <p>Badges : <strong id="dash-rpg-badges">0/50</strong></p>
                        <button class="btn-primary" onclick="switchModule('module3')">Voir RPG</button>
                    </div>
                    <div class="dashboard-card">
                        <h3>ğŸ“– ScÃ©narios</h3>
                        <p>Lus : <strong id="dash-scenarios-read">0/600</strong></p>
                        <p>CatÃ©gories : <strong>~20</strong></p>
                        <button class="btn-primary" onclick="switchModule('scenarios')">Parcourir</button>
                    </div>
                </div>
                <div class="quick-actions">
                    <button class="btn-secondary" onclick="importData()">ğŸ“¥ Importer</button>
                    <button class="btn-secondary" onclick="exportData()">ğŸ“¤ Exporter</button>
                    <button class="btn-secondary" onclick="resetAll()">ğŸ”„ Reset</button>
                </div>
            </div>

            <!-- MODULES EXTERNES -->
            <!-- (contenu identique Ã  ton fichier â€” je garde tout) -->

            <div id="module-module1" class="module-content">
                <h2>ğŸ“… Module 1 - Suivi Annuel</h2>
                <div class="external-module-info">
                    <div class="info-card">
                        <h3>ğŸ“‚ Module externe</h3>
                        <p>Ouvrez le Module 1 dans un autre onglet pour saisir vos heures.</p>
                        <ol><li>Cliquer le bouton ci-dessous</li><li>Saisir vos heures</li><li>Revenir ici â€” sync auto !</li></ol>
                        <a href="modules/module1-annuel.html" target="_blank" class="btn-primary">ğŸ“… Ouvrir Module 1</a>
                    </div>
                </div>
            </div>

            <div id="module-module2" class="module-content">
                <h2>ğŸ“† Module 2 - Suivi Mensuel</h2>
                <div class="external-module-info">
                    <div class="info-card">
                        <h3>ğŸ“‚ Module externe</h3>
                        <a href="modules/module2-mensuel.html" target="_blank" class="btn-primary">ğŸ“† Ouvrir Module 2</a>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- SCRIPTS -->
    <script src="js/modes.js"></script>
    <script src="js/safety.js"></script>
    <script src="js/assets-config.js"></script>
    <script src="js/config.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/data-bridge.js"></script>
    <script src="js/module-loader.js"></script>
    <script src="js/scenarios-fox-data.js"></script>
    <script src="js/scenarios-fox.js"></script>
    <script src="js/rpg-system.js"></script>
    <script src="js/module1.js"></script>
    <script src="js/module2.js"></script>
    <script src="js/module3.js"></script>
    <script src="js/main.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            try {
                const season = getCurrentSeason();
                const foxMain = document.getElementById('fox-img-container');
                if (foxMain && typeof getFoxAsset === 'function') {
                    foxMain.innerHTML = getFoxAsset(season, '120px');
                }
                const foxRPG = document.getElementById('rpg-fox-avatar');
                if (foxRPG && typeof getFoxAsset === 'function') {
                    foxRPG.innerHTML = getFoxAsset(season, '50px');
                }
                if (typeof applySeasonBackground === 'function') {
                    applySeasonBackground(season);
                }
            } catch(e) {
                console.warn('Renard/saison non chargÃ© :', e);
            }
        });
    </script>

</body>
</html>
